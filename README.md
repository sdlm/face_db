# face_db
DB for store face features

# общий план
1. загружаем фотку, выдернуть из неё лица людей
2. по выдернутым лицам найти их отображение в вектора
3. провести поиск векторов по базе профилей
4. выдать список профилей (тех людей что были на фото)

# разбиваем на сервисы

## базы
1. исходные фотки
2. фичи с фоток (1)
3. профили (+фото)
4. фичи с фоток (3)

## сервисы
1. краулер по базе 1 (наполнение базы 2)
2. апи для заведения профилей (наполнение базы 3)
3. апи для поиска заданного профиля (поиск фич указанных в базе 4 по базе 2)

# сервисы подробнее

## Сервис 1. Обход базы фоток, наполнение базы фич.
1. планировщик: запросить все необработанные фотки, создать на них задачи
2. задачи имебт вид
  1. выделить лица на фото
  2. выделить фичи
  3. записать фичи в базу

# базы подробнее

1. фото
  1. фото
  2. гео данные
  3. ссылка
  4. uuid аккаунта

2. фичи
  1. fk на фото
  2. фичи
  3. fk на профиль

3. профили
  1. UUID
  2. усредненные фичи

## Заметки

- при поступлении запроса поиска по фото:
  1. выдираем первое лицо с фото
  2. выдираем фичи
  3. ищем фичи по базе профилей
    - если есть, то отдаем профиль
    - если нет, то проводим поиск по базе фич

- "индексация", берем пачку фич, проводим поиск похожих, если есть похожие то создаем по ним профиль
  - поиск похожих среди [1..N]:
    1. взять очередную фичу K
    2. сравнить её со всеми [K..N]
    3. если нашлись похожие, то выставить им fk на фичу K, и исключить из дальнейших сравнений
